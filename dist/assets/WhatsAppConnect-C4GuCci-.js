import{j as e}from"./ui-B2Y7o2X1.js";import{r as u}from"./vendor-BsBmf7g_.js";import{b as oe,u as te,B as w,C as _,c as D,d as L,e as re,f as O,s as C}from"./index-BYGJTMIk.js";import{I as ce}from"./input-CJFPxKXQ.js";import{L as ie}from"./label-Dg_mNZli.js";import{u as de}from"./router-Bs1VKYaT.js";import{s as le,a2 as k,C as W,Z as me,a3 as F,a4 as U,a5 as H,f as xe,a as P}from"./icons-BPYBiv7x.js";import{K as ue,L as pe,Z as ge}from"./utils-CftW5NT4.js";const he=ue({instanceName:pe().min(3,"Nome da inst√¢ncia deve ter pelo menos 3 caracteres").max(50,"Nome da inst√¢ncia deve ter no m√°ximo 50 caracteres").regex(/^[a-z0-9]+$/,"Use apenas letras min√∫sculas e n√∫meros (sem h√≠fens ou caracteres especiais)")});function Ee(){const{user:r}=oe(),{toast:x}=te(),J=de(),[c,E]=u.useState({instanceName:""}),[I,T]=u.useState({}),[A,G]=u.useState(!1),[N,f]=u.useState(!1),[q,p]=u.useState(""),[j,g]=u.useState(""),[t,i]=u.useState("idle"),[M,S]=u.useState(60),[R,v]=u.useState(!1),Y=s=>{const a=Date.now(),n=Math.random().toString(36).substring(2,6);return`${s}${a}${n}`},Q=()=>{S(60),v(!1)},Z=async()=>{if(c.instanceName)try{console.log(`üîç Verificando se inst√¢ncia existe: ${c.instanceName}`),console.log(`üîç Estado atual: instanceCreated=${N}, instanceStatus=${t}`);const s=await se(c.instanceName);if(s){console.log("üíæ Inst√¢ncia encontrada no banco:",s),g(s.instance_id),f(!0);const a=await fetch(`https://api.aiensed.com/instance/connectionState/${c.instanceName}`,{method:"GET",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"}});if(a.ok){const n=await a.json();console.log("üîç Resposta da API:",n),n.instance?n.instance.state==="open"?(console.log("üéâ WhatsApp CONECTADO! (state: open)"),i("connected"),y(c.instanceName,"connected")):(console.log(`üì± WhatsApp DESCONECTADO! (state: ${n.instance.state})`),i("disconnected"),y(c.instanceName,"disconnected")):(console.log("‚ùå Inst√¢ncia n√£o existe na API (foi exclu√≠da)"),i("disconnected"),y(c.instanceName,"disconnected"))}else a.status===404&&(console.log("üö® Inst√¢ncia n√£o encontrada na API (404) - REMOVENDO DO BANCO!"),await B(c.instanceName),i("idle"),f(!1),p(""),g(""),x({title:"Inst√¢ncia Removida",description:"A inst√¢ncia foi removida da API e exclu√≠da do banco.",variant:"destructive"}))}else console.log("‚ùå Inst√¢ncia n√£o existe no banco"),i("idle"),f(!1),p(""),g("")}catch(s){console.log("‚ùå Erro ao verificar inst√¢ncia:",s),i("error")}},$=async()=>{if(!(!j||!c.instanceName))try{console.log(`üîç Verificando status da inst√¢ncia: ${c.instanceName} (ID: ${j})`),console.log(`üîç Status atual: ${t}`);try{const s=await fetch(`https://api.aiensed.com/instance/connectionState/${c.instanceName}`,{method:"GET",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"}});if(s.ok){const a=await s.json();if(console.log("üîç Resposta da verifica√ß√£o de status:",a),a.instance&&a.instance.state==="open"){console.log("üéâ WhatsApp CONECTADO! (state: open)"),y(c.instanceName,"connected"),t!=="connected"&&(i("connected"),v(!1),x({title:"WhatsApp Conectado!",description:"Sua inst√¢ncia est√° ativa e pronto para receber dados."}));return}if(a.instance&&a.instance.state!=="open"){console.log(`üì± WhatsApp DESCONECTADO! (state: ${a.instance.state})`),t!=="disconnected"&&(i("disconnected"),y(c.instanceName,"disconnected"),console.log("üîç Verificando se deve gerar QR autom√°tico:"),console.log("üîç instanceStatus atual:",t),console.log("üîç qrCode existe:",!!q),console.log("üîç instanceStatus !== qr_ready:",t!=="qr_ready"),console.log("üîç !qrCode:",!q),console.log("üîÑ Inst√¢ncia desconectada - gerando QR code para reconex√£o..."),console.log("üîÑ Chamando generateQrCodeForExistingInstance..."),setTimeout(()=>{console.log("üîÑ Executando gera√ß√£o de QR code ap√≥s delay..."),K(c.instanceName)},1e3));return}}else if(s.status===404){console.log("üö® Inst√¢ncia n√£o encontrada na API (404) - REMOVENDO DO BANCO!"),await B(c.instanceName),i("idle"),f(!1),p(""),g(""),x({title:"Inst√¢ncia Removida",description:"A inst√¢ncia foi removida da API e exclu√≠da do banco.",variant:"destructive"});return}else if(s.status===403){console.log("üö´ Acesso negado (403) - verificar permiss√µes");return}}catch(s){console.log("‚ùå Erro ao verificar status:",s)}console.log("üì± Inst√¢ncia n√£o est√° conectada"),t==="connected"&&(i("disconnected"),x({title:"WhatsApp Desconectado",description:"A conex√£o foi perdida.",variant:"destructive"}))}catch(s){console.log("‚ùå Erro na verifica√ß√£o:",s)}},K=async s=>{if(!s)return;console.log(`üîÑ Gerando QR code para inst√¢ncia existente: ${s}`),v(!1),S(60),i("creating");const a=[`https://api.aiensed.com/instance/connect/${s}`,`https://api.aiensed.com/instance/${s}/connect`,`https://api.aiensed.com/instance/connect?instance=${s}`,"https://api.aiensed.com/instance/create"];for(let n=0;n<a.length;n++){const o=a[n],d=o.includes("/instance/connect/")&&!o.includes("?");console.log(d?`üéØ TESTANDO ENDPOINT OFICIAL DA DOCUMENTA√á√ÉO: ${o}`:`üîç Testando endpoint ${n+1}/${a.length}: ${o}`);try{let l;if(o.includes("/instance/create")?(console.log("‚ö†Ô∏è Usando endpoint POST /instance/create (n√£o recomendado para regenerar QR)"),l=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"},body:JSON.stringify({instanceName:s,qrcode:!0,integration:"WHATSAPP-BAILEYS"})})):(d&&console.log("‚úÖ Usando endpoint oficial GET /instance/connect/{instance}"),l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"}})),console.log(`üîç Endpoint ${o}: Status ${l.status}`),l.ok){const m=await l.json();console.log(`üîç Resposta do endpoint ${o}:`,m);let h=null,b=null;if(m.base64?(h=m.base64,b=m.pairingCode||"N/A",console.log("‚úÖ QR code encontrado no campo base64")):m.code?(h=m.code,b=m.pairingCode||"N/A",console.log("‚úÖ QR code encontrado no campo code")):m.qrcode?(h=m.qrcode.base64||m.qrcode,b="N/A",console.log("‚úÖ QR code encontrado no campo qrcode")):m.qrCode&&(h=m.qrCode,b="N/A",console.log("‚úÖ QR code encontrado no campo qrCode")),h){console.log("‚úÖ QR code encontrado!",{endpoint:o,qrCode:h.substring(0,50)+"...",pairingCode:b}),p(h),i("qr_ready"),Q(),console.log("‚úÖ QR code gerado com sucesso"),x({title:"QR Code Gerado!",description:`Endpoint: ${o.split("/").pop()}. C√≥digo: ${b}`});return}}else console.log(`‚ùå Endpoint ${o} falhou: ${l.status} ${l.statusText}`)}catch(l){console.error(`‚ùå Erro no endpoint ${o}:`,l)}}console.error("‚ùå Nenhum endpoint funcionou para gerar QR code"),i("error"),x({title:"Erro ao Gerar QR Code",description:"Todos os endpoints testados falharam. Verifique o console.",variant:"destructive"})},V=async()=>{if(c.instanceName){v(!1),S(60),i("creating");try{const s=await fetch("https://api.aiensed.com/instance/create",{method:"POST",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"},body:JSON.stringify({instanceName:c.instanceName,qrcode:!0,integration:"WHATSAPP-BAILEYS"})});if(s.ok){const a=await s.json();a.qrcode&&a.instance&&(p(a.qrcode.base64||a.qrcode),g(a.instance.instanceId||a.instance.id),i("qr_ready"),Q(),x({title:"QR Code Regenerado!",description:"Escaneie o novo QR Code com seu WhatsApp."}))}else i("error"),x({title:"Erro ao Regenerar",description:"N√£o foi poss√≠vel gerar um novo QR Code.",variant:"destructive"})}catch{i("error"),x({title:"Erro ao Regenerar",description:"Erro de conex√£o ao gerar novo QR Code.",variant:"destructive"})}}},X=()=>{try{return he.parse(c),T({}),!0}catch(s){if(s instanceof ge){const a={};s.errors.forEach(n=>{n.path[0]&&(a[n.path[0]]=n.message)}),T(a)}return!1}},ee=(s,a)=>{E(n=>({...n,[s]:a})),I[s]&&T(n=>({...n,[s]:void 0}))},ae=async()=>{if(!X()||!r){x({title:"Erro de valida√ß√£o",description:"Por favor, corrija os erros no formul√°rio.",variant:"destructive"});return}G(!0),i("creating");try{const s=await fetch("https://api.aiensed.com/instance/create",{method:"POST",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"},body:JSON.stringify({instanceName:c.instanceName,qrcode:!0,integration:"WHATSAPP-BAILEYS"})});if(s.ok){const a=await s.json();console.log("üîç Resposta completa da API:",a);let n=null,o=null,d=null;if(a.qrcode&&(typeof a.qrcode=="string"?n=a.qrcode:a.qrcode.base64?n=a.qrcode.base64:a.qrcode.code&&(n=a.qrcode.code)),a.instance&&(typeof a.instance=="string"?o=a.instance:a.instance.instanceId?o=a.instance.instanceId:a.instance.id&&(o=a.instance.id),a.instance.instanceName&&(d=a.instance.instanceName)),!o&&a.instanceId&&(o=a.instanceId),!o&&a.instance_id&&(o=a.instance_id),!o&&a.id&&(o=a.id),!n&&a.qrCode&&(n=a.qrCode),!n&&a.qr&&(n=a.qr),!n&&a.qrcode_url&&(n=a.qrcode_url),n&&o){console.log("üéØ Dados v√°lidos recebidos:",{qrCode:!!n,instanceId:o,instanceName:d}),p(n),g(o),f(!0),i("qr_ready"),console.log("üíæ Estado atualizado, salvando no banco...");const l=await z(c.instanceName,o,n);l&&console.log("‚úÖ Inst√¢ncia salva com sucesso no banco:",l),console.log("‚è∞ Aguardando 10 segundos para estabilizar inst√¢ncia..."),setTimeout(()=>{console.log("üîç Iniciando verifica√ß√£o de status ap√≥s estabiliza√ß√£o..."),$()},1e4),x({title:"QR Code Gerado!",description:`Inst√¢ncia "${d||o}" criada com sucesso. Agora escaneie o QR Code!`})}else throw new Error("API n√£o retornou dados esperados. Verifique o console para detalhes.")}else if(s.status===403)try{const a=await s.text();if(console.log("üö® Erro 403:",a),a.toLowerCase().includes("already in use")){const n=Y(c.instanceName);console.log(`üîÑ Tentando com nome √∫nico: ${n}`);const o=await fetch("https://api.aiensed.com/instance/create",{method:"POST",headers:{"Content-Type":"application/json",apikey:"d3050208ba862ee87302278ac4370cb9"},body:JSON.stringify({instanceName:n,qrcode:!0,integration:"WHATSAPP-BAILEYS"})});if(o.ok){const d=await o.json();let l=null,m=null;d.qrcode&&(l=d.qrcode.base64||d.qrcode),d.instance&&(m=d.instance.instanceId||d.instance.id),l&&m&&(E(h=>({...h,instanceName:n})),p(l),g(m),f(!0),i("qr_ready"),await z(n,m,l),x({title:"QR Code Gerado!",description:`Inst√¢ncia "${n}" criada com nome √∫nico. Agora escaneie o QR Code!`}))}else throw new Error(`Retry com nome √∫nico falhou: ${o.status}`)}else throw new Error(`Erro 403: ${a}`)}catch(a){throw new Error(`Erro ao processar resposta 403: ${a}`)}else throw new Error(`API retornou erro: ${s.status}`)}catch(s){console.error("Erro ao conectar:",s),i("error"),x({title:"Erro na conex√£o",description:`Erro: ${s instanceof Error?s.message:"Desconhecido"}`,variant:"destructive"})}finally{G(!1)}},z=async(s,a,n)=>{if(!(r!=null&&r.id)){console.error("‚ùå Usu√°rio n√£o autenticado");return}try{console.log("üíæ Salvando inst√¢ncia no banco:",{instanceName:s,instanceId:a});const{data:o,error:d}=await C.from("whatsapp_instances").insert({user_id:r.id,instance_name:s,instance_id:a,status:"connecting",qr_code:n,is_active:!0}).select().single();if(d)throw console.error("‚ùå Erro ao salvar no banco:",d),d;return console.log("‚úÖ Inst√¢ncia salva no banco:",o),o}catch(o){console.error("‚ùå Erro ao salvar inst√¢ncia:",o),x({title:"Erro ao salvar",description:"N√£o foi poss√≠vel salvar a inst√¢ncia no banco de dados.",variant:"destructive"})}},se=async s=>{if(!(r!=null&&r.id))return null;try{const{data:a,error:n}=await C.from("whatsapp_instances").select("*").eq("user_id",r.id).eq("instance_name",s).eq("is_active",!0).single();return n&&n.code!=="PGRST116"?(console.error("‚ùå Erro ao buscar no banco:",n),null):a}catch(a){return console.error("‚ùå Erro ao verificar banco:",a),null}},ne=async()=>{if(r!=null&&r.id)try{console.log("üîç Carregando inst√¢ncias existentes do usu√°rio...");const{data:s,error:a}=await C.from("whatsapp_instances").select("*").eq("user_id",r.id).eq("is_active",!0).order("created_at",{ascending:!1});if(a){console.error("‚ùå Erro ao carregar inst√¢ncias:",a);return}if(s&&s.length>0){console.log("üíæ Inst√¢ncias encontradas no banco:",s);const n=s[0];console.log("üéØ Inst√¢ncia mais recente:",n),E({instanceName:n.instance_name}),g(n.instance_id),f(!0),n.qr_code&&p(n.qr_code),setTimeout(()=>Z(),1e3)}else console.log("üì≠ Nenhuma inst√¢ncia encontrada no banco")}catch(s){console.error("‚ùå Erro ao carregar inst√¢ncias:",s)}},y=async(s,a)=>{if(r!=null&&r.id)try{console.log(`üíæ Atualizando status no banco: ${s} ‚Üí ${a}`);const{error:n}=await C.from("whatsapp_instances").update({status:a,updated_at:new Date().toISOString()}).eq("user_id",r.id).eq("instance_name",s);n?console.error("‚ùå Erro ao atualizar status:",n):console.log(`‚úÖ Status atualizado no banco: ${s} ‚Üí ${a}`)}catch(n){console.error("‚ùå Erro ao atualizar status:",n)}},B=async s=>{if(r!=null&&r.id)try{console.log(`üóëÔ∏è Excluindo inst√¢ncia √≥rf√£ do banco: ${s}`);const{error:a}=await C.from("whatsapp_instances").delete().eq("user_id",r.id).eq("instance_name",s);a?console.error("‚ùå Erro ao excluir inst√¢ncia do banco:",a):console.log(`‚úÖ Inst√¢ncia exclu√≠da do banco: ${s}`)}catch(a){console.error("‚ùå Erro ao excluir inst√¢ncia do banco:",a)}};return u.useEffect(()=>{r!=null&&r.id&&(console.log("üöÄ Componente montado, carregando inst√¢ncias existentes..."),ne())},[r==null?void 0:r.id]),u.useEffect(()=>{N&&c.instanceName&&(console.log("üîç Verifica√ß√£o inicial de status..."),setTimeout(()=>{$()},2e3))},[N,c.instanceName]),u.useEffect(()=>{let s,a;return t==="qr_ready"&&j&&(Q(),s=setInterval(()=>{S(n=>n<=1?(v(!0),0):n-1)},1e3),a=setInterval(()=>{console.log("üîç Verifica√ß√£o inteligente de status (QR ready)..."),$()},6e4)),t==="connected"&&j&&(a=setInterval(()=>{console.log("üîç Verifica√ß√£o inteligente de status (connected)..."),$()},15e3)),()=>{s&&clearInterval(s),a&&clearInterval(a)}},[t,j]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"relative overflow-hidden border-b border-border/50 bg-background/80 backdrop-blur-xl supports-[backdrop-filter]:bg-background/60 sticky top-0 z-50",children:e.jsx("div",{className:"relative container mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{variant:"ghost",onClick:()=>J("/dashboard"),className:"text-foreground hover:bg-muted transition-all duration-300 rounded-xl px-4 py-2",children:[e.jsx(le,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-medium text-sm",children:"Voltar ao Dashboard"})]}),e.jsxs("div",{className:"text-center flex-1 max-w-2xl mx-auto",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-8 h-8 bg-gradient-to-r from-primary to-primary/80 rounded-lg mb-3",children:e.jsx(k,{className:"h-5 w-5 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold mb-2 text-foreground",children:"Conectar WhatsApp"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-xl mx-auto leading-relaxed",children:"Configure sua inst√¢ncia para an√°lise de dados e integra√ß√£o com o sistema"})]}),e.jsx("div",{className:"w-20"})]})})}),e.jsxs("div",{className:"container mx-auto px-6 py-12",children:[e.jsx("div",{className:"mb-8 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-2xl backdrop-blur-sm shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),e.jsxs("p",{className:"text-sm text-blue-700 font-medium",children:[e.jsx("strong",{children:"Debug:"})," Usu√°rio: ",(r==null?void 0:r.email)||"N√£o autenticado"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-8",children:[e.jsxs(_,{className:"shadow-sm border border-border/50 bg-card/50 backdrop-blur-sm rounded-xl overflow-hidden",children:[e.jsx(D,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-primary to-primary/80 rounded-lg",children:e.jsx(k,{className:"h-5 w-5 text-white m-auto mt-1.5"})}),e.jsxs("div",{children:[e.jsx(L,{className:"text-lg font-semibold",children:"Configura√ß√£o da Inst√¢ncia"}),e.jsx(re,{className:"text-sm text-muted-foreground",children:"Crie uma nova inst√¢ncia do WhatsApp para an√°lise de dados"})]})]})}),e.jsx(O,{className:"p-8 space-y-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-8 rounded-3xl border border-blue-100 shadow-sm",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ie,{htmlFor:"instanceName",className:"text-xl font-semibold text-gray-800",children:"üè∑Ô∏è Nome da Inst√¢ncia"}),e.jsx("div",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:"Obrigat√≥rio"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{id:"instanceName",type:"text",placeholder:"Ex: lojamoveis, empresaabc, vendas2024",value:c.instanceName,onChange:s=>ee("instanceName",s.target.value),className:`text-lg p-5 border-2 transition-all duration-300 ${I.instanceName?"border-red-400 focus:border-red-500 focus:ring-red-200":"border-blue-200 focus:border-blue-500 focus:ring-blue-200"} rounded-2xl focus:ring-4 focus:ring-blue-100`,disabled:A}),I.instanceName&&e.jsxs("p",{className:"mt-3 text-sm text-red-600 font-medium flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),I.instanceName]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"Dica de Nomenclatura"})]}),e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Use apenas ",e.jsx("strong",{children:"letras min√∫sculas"})," e ",e.jsx("strong",{children:"n√∫meros"})," (sem h√≠fens ou caracteres especiais). Exemplos: ",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-blue-600",children:"lojamoveis"}),",",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-blue-600",children:"empresaabc"}),",",e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-blue-600",children:"vendas2024"})]})]})]})}),e.jsx("div",{className:"text-center pt-4",children:e.jsx(w,{onClick:ae,disabled:A||!c.instanceName,className:`w-full max-w-lg h-20 text-xl font-bold rounded-3xl shadow-2xl transition-all duration-500 ${A||!c.instanceName?"bg-gray-400 cursor-not-allowed shadow-none":"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 hover:from-blue-700 hover:via-indigo-700 hover:to-purple-700 hover:scale-105 hover:shadow-3xl"}`,size:"lg",children:A?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),e.jsx("span",{children:"Conectando WhatsApp..."})]}):e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(me,{className:"h-7 w-7"}),e.jsx("span",{children:"Conectar WhatsApp"})]})})})]})})]}),(t!=="idle"||N)&&e.jsxs(_,{className:"shadow-2xl border-0 bg-white/90 backdrop-blur-sm rounded-3xl overflow-hidden",children:[e.jsx(D,{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t==="creating"&&e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}),t==="qr_ready"&&e.jsx("div",{className:"p-2 bg-green-100 rounded-xl",children:e.jsx(F,{className:"h-6 w-6 text-green-600"})}),t==="connected"&&e.jsx("div",{className:"p-2 bg-green-100 rounded-xl",children:e.jsx(U,{className:"h-6 w-6 text-green-600"})}),t==="error"&&e.jsx("div",{className:"p-2 bg-red-100 rounded-xl",children:e.jsx(W,{className:"h-6 w-6 text-red-600"})}),t==="disconnected"&&e.jsx("div",{className:"p-2 bg-orange-100 rounded-xl",children:e.jsx(H,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[t==="creating"&&"Criando Inst√¢ncia...",t==="qr_ready"&&"QR Code Gerado!",t==="connected"&&"WhatsApp Conectado!",t==="error"&&"Erro na Conex√£o",t==="disconnected"&&"WhatsApp Desconectado"]}),e.jsxs("p",{className:"text-gray-600",children:[t==="creating"&&"Aguarde enquanto criamos sua inst√¢ncia...",t==="qr_ready"&&"Escaneie o QR Code com seu WhatsApp",t==="connected"&&"Sua inst√¢ncia est√° ativa e funcionando",t==="error"&&"Ocorreu um erro durante a conex√£o",t==="disconnected"&&"A conex√£o foi perdida"]})]})]})}),e.jsxs(O,{className:"p-6",children:[(t==="qr_ready"||N&&t!=="connected")&&q&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"space-y-6 order-2 lg:order-1",children:[!R&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-2xl shadow-sm",children:[e.jsx(xe,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("span",{className:"text-lg font-semibold text-yellow-700",children:["QR Code expira em: ",e.jsxs("strong",{className:"text-2xl",children:[M,"s"]})]})]}),R&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-2xl shadow-sm",children:[e.jsx(W,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"text-lg font-semibold text-red-700",children:'QR Code expirado! Clique em "Gerar Novo QR Code"'})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-2xl border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"üì± Como Escanear:"}),e.jsxs("ol",{className:"text-sm text-blue-700 space-y-1 text-left",children:[e.jsxs("li",{children:["1. Abra o ",e.jsx("strong",{children:"WhatsApp Business"})]}),e.jsxs("li",{children:["2. V√° em ",e.jsx("strong",{children:"Configura√ß√µes"})]}),e.jsxs("li",{children:["3. Toque em ",e.jsx("strong",{children:"Dispositivos Vinculados"})]}),e.jsx("li",{children:"4. Escaneie o QR Code acima"})]})]})}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-start",children:R&&e.jsxs(w,{onClick:V,variant:"outline",size:"lg",className:"bg-orange-50 border-orange-200 text-orange-700 hover:bg-orange-100 rounded-2xl px-8",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Gerar Novo QR Code"]})})]}),e.jsx("div",{className:"order-1 lg:order-2 flex justify-center lg:justify-end",children:e.jsx("div",{className:"bg-white p-6 rounded-3xl border-2 border-gray-200 shadow-lg",children:e.jsx("img",{src:q,alt:"QR Code WhatsApp",className:`w-56 h-56 ${R?"opacity-50 grayscale":""} transition-all duration-300`})})})]}),t==="connected"&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-green-100 to-emerald-100 rounded-full mb-6 shadow-lg",children:e.jsx(P,{className:"h-12 w-12 text-green-600"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-3xl font-bold text-green-600",children:"üéâ WhatsApp Conectado!"}),e.jsx("p",{className:"text-xl text-green-700 font-medium",children:"Inst√¢ncia Ativa e Funcionando"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-3xl p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-lg font-semibold text-green-700",children:"Status: Conectado e Ativo"})]}),e.jsx("p",{className:"text-green-600 leading-relaxed",children:"Sua inst√¢ncia est√° pronta para receber e processar dados do WhatsApp. Os dados ser√£o coletados automaticamente e estar√£o dispon√≠veis no dashboard."})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-4 max-w-md mx-auto"}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6 max-w-lg mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsx(P,{className:"h-6 w-6 text-green-600"}),e.jsx("span",{className:"text-lg font-semibold text-green-700",children:"Conex√£o Estabelecida com Sucesso!"})]}),e.jsx("p",{className:"text-green-600",children:"Voc√™ pode fechar esta p√°gina. A inst√¢ncia continuar√° funcionando e coletando dados automaticamente."})]})]}),t==="disconnected"&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-orange-100 to-red-100 rounded-full mb-6 shadow-lg",children:e.jsx(H,{className:"h-12 w-12 text-orange-600"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-3xl font-bold text-orange-600",children:"‚ö†Ô∏è WhatsApp Desconectado"}),e.jsx("p",{className:"text-xl text-orange-700 font-medium",children:"A conex√£o foi perdida"})]}),e.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-3xl p-6 shadow-sm",children:e.jsx("p",{className:"text-orange-700 leading-relaxed",children:"Sua inst√¢ncia foi desconectada ou removida da API. Gere um novo QR Code para reconectar e continuar coletando dados."})}),e.jsxs(w,{onClick:V,className:"bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-bold rounded-2xl px-8 py-4 text-lg shadow-lg hover:shadow-xl transition-all duration-300",size:"lg",children:[e.jsx(U,{className:"h-6 w-6 mr-3"}),"Reconectar WhatsApp"]})]}),t==="connected"&&e.jsx("div",{className:"text-center pt-6",children:e.jsxs(w,{onClick:()=>{i("idle"),f(!1),p(""),g(""),E({instanceName:""}),console.log("üóëÔ∏è Estado limpo - nova inst√¢ncia")},variant:"outline",size:"lg",className:"border-gray-300 text-gray-700 hover:bg-gray-50 rounded-2xl px-8 py-3",children:[e.jsx(k,{className:"h-5 w-5 mr-2"}),"Criar Nova Inst√¢ncia"]})})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(_,{className:"shadow-sm border border-border/50 bg-card/50 backdrop-blur-sm rounded-xl overflow-hidden",children:[e.jsx(D,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-green-500 to-green-600 rounded-lg",children:e.jsx(P,{className:"h-5 w-5 text-white m-auto mt-1.5"})}),e.jsx(L,{className:"text-lg font-semibold",children:"Como Funciona"})]})}),e.jsx(O,{className:"p-6",children:e.jsxs("div",{className:"space-y-4 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2"}),e.jsx("p",{children:"Digite o nome da inst√¢ncia (apenas letras e n√∫meros)"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),e.jsx("p",{children:'Clique em "Conectar WhatsApp" para gerar o QR Code'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-2"}),e.jsx("p",{children:"Escaneie o QR Code com seu WhatsApp Business"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full mt-2"}),e.jsx("p",{children:"A inst√¢ncia ser√° criada e conectada automaticamente"})]})]})})]})})]})]})]})}export{Ee as default};
